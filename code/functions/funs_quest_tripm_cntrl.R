

library("here")
library("tidyverse")
library("forcats")



save_raw_quest_tripm_cntrl <- function() {
  
  # TRIPM -------------------------------------------------------------------
  
  temp <- rio::import(
    here(
      "data", "raw", "quest", "TRIPM (Risposte).xlsx"
    )
  )
  
  
  tripm_all <- temp[, 3:61] %>% 
    rename(
      subj_code = `Codice identificativo: prime due lettere del nome_prime due lettere del cognome_anno nascita_mese nascita_giorno_ultime tre cifre del cellulare_sesso. Esempio di Mario Rossi, nato il 23 Marzo 1993: ma_ro_1993_03_23_692_m.`,
      TRIPM_1 = `1) Il più delle volte sono ottimista`,
      TRIPM_2 = `2) Per me è importante come gli altri si sentono`,
      TRIPM_3 = "3) Spesso agisco in base a bisogni immediati",
      TRIPM_4 = "4) Non ho un particolare desiderio di paracadutarmi da un aereo",
      TRIPM_5 = "5) Spesso sono venuto/a meno a cose di cui avevo promesso di occuparmi",
      TRIPM_6 = "6) Mi divertirebbe trovarmi in un inseguimento ad alta velocità",
      TRIPM_7 = "7) Sono ben equipaggiato/a per affrontare lo stress",
      TRIPM_8 = "8) Non mi importa se una persona che non mi piace si fa male",
      TRIPM_9 = "9) Le mie decisioni impulsive hanno causato problemi coi miei cari",
      TRIPM_10 = "10) Mi spavento facilmente",
      TRIPM_11 = "11) Mi sento vicino ai problemi degli altri",
      TRIPM_12 = "12) Ci sono state volte in cui non sono andato/a al lavoro e non mi sono preoccupato/a di avvertire",
      TRIPM_13 = "13) Sono un/a leader nato/a" ,
      TRIPM_14 = "14) Un buon scontro fisico mi diverte",
      TRIPM_15 = "15) Mi butto nelle cose senza pensarci",
      TRIPM_16 = "16) Ho difficoltà a far andare le cose come vorrei",
      TRIPM_17 = "17) Restituisco gli insulti",
      TRIPM_18 = "18) Mi sono messo/a nei guai poiché ho saltato spesso la scuola",
      TRIPM_19 = "19) Ho un talento nell' influenzare gli altri",
      TRIPM_20 = "20) Non mi turba vedere qualcun altro che soffre" ,
      TRIPM_21 = "21) Ho un buon autocontrollo",
      TRIPM_22 = "22) So come cavarmela nelle nuove situazioni anche quando sono impreparato/a",
      TRIPM_23 = "23) Qualche volta mi piace fare il/la prepotente",
      TRIPM_24 = "24) Ho preso dei soldi dal portafoglio o dalla borsa di qualcuno senza chiedere il permesso",
      TRIPM_25 = "25) Non credo di avere particolari talenti",
      TRIPM_26 = "26) Prendo in giro gli altri solo per creare scompiglio",
      TRIPM_27 = "27) Spesso le persone abusano della mia fiducia.",
      TRIPM_28 = "28) Mi impauriscono molte meno cose rispetto alla maggior parte delle persone",
      TRIPM_29 = "29) Non vedo alcun motivo per dovermi preoccupare se quello che faccio fa soffrire qualcun altro", 
      TRIPM_30 = "30) Rispetto gli appuntamenti che prendo", 
      TRIPM_31 = "31) Mi annoio facilmente e perdo interesse nelle cose che faccio",
      TRIPM_32 = "32) Riesco a superare cose che traumatizzerebbero gli altri",
      TRIPM_33 = "33) Sono sensibile ai sentimenti altrui",
      TRIPM_34 = "34) Ho ingannato delle persone per ottenere dei soldi da loro",
      TRIPM_35 = "35) Mi preoccupa trovarmi in una situazione inconsueta senza conoscere tutti i dettagli",
      TRIPM_36 = "36) Non provo molta compassione per gli altri",
      TRIPM_37 = "37) Mi metto nei guai per non aver considerato le conseguenze delle mie azioni" ,
      TRIPM_38 = "38) Posso convincere gli altri a fare ciò che voglio",
      TRIPM_39 = "39) Per me l'onestà è sicuramente la migliore strategia",
      TRIPM_40 = "40) Ho fatto del male a qualcuno per vederlo soffrire",
      TRIPM_41 = "41) Non mi piace prendere il comando in un gruppo",
      TRIPM_42 = "42) Talvolta insulto di proposito le persone per ottenere una loro reazione",
      TRIPM_43 = "43) Ho preso degli oggetti da un negozio senza pagarli",
      TRIPM_44 = "44) E’ facile mettermi in imbarazzo",
      TRIPM_45 = "45) Le cose sono più divertenti se sono un po' rischiose",
      TRIPM_46 = "46) Mi è difficile aspettare pazientemente le cose che voglio",
      TRIPM_47 = "47) Cerco di stare il più possibile lontano dai pericoli fisici" ,
      TRIPM_48 = "48) Non mi importa molto se quello che faccio ferisce gli altri",
      TRIPM_49 = "49) Ho perso un amico a causa delle mie condotte irresponsabili",
      TRIPM_50 = "50) Non mi sento all'altezza della maggior parte delle altre persone",
      TRIPM_51 = "51) Alcuni mi hanno detto di essere preoccupati per la mia mancanza di auto-controllo",
      TRIPM_52 = "52) Mi riesce facile immedesimarmi con le emozioni degli altri",
      TRIPM_53 = "53) Ho derubato qualcuno",
      TRIPM_54 = "54) Non mi hai mai preoccupato fare brutte figure davanti agli altri",
      TRIPM_55 = "55) Non mi importa se le persone attorno a me stanno soffrendo",
      TRIPM_56 = "56) Ho avuto problemi al lavoro perché sono stato/a irresponsabile",
      TRIPM_57 = "57) Non sono molto bravo/a nell'influenzare gli altri",
      TRIPM_58 = "58) Ho rubato qualcosa da un veicolo"
    ) 
  
  # the second string is what must be changed; 
  # the first sting is the way in which you want it to be changed
  tripm_all$subj_code <- fct_recode(
    tripm_all$subj_code, 
    "ca_ug_1999_06_22_827_f" = "Ca_ug_1999_06_22_827_f", 
    "ch_na_1999_08_09_083_f" = "ch_na_1999_08_09_083_f.",
    "ch_vo_1999_05_12_768_f" = "Ch_vo_1999_05_12_768_f",
    "li_st_1997_02_07_509_f" = "LI_ST_1997_02_07_509_F",
    "si_si_1999_03_09_270_f" = "sisi19990909270f",
    "ch_na_1999_08_09_083_f" = "ch_na_1999_08_09_083_f.",
    "ca_ug_1999_06_22_827_f" = "Ca_ug_1999_06_22_827_f",
    "ch_vo_1999_05_12_768_f" = "Ch_vo_1999_05_12_768_f",
    "ce_va_1998_08_24_343_f" = "ce_va_1998_08_24_343_f.",
    "re_pa_1999_10_29_898_f" = "re_pa_1999_10_29_898_f.",
    "li_st_1997_02_07_509_f" = "LI_ST_1997_02_07_509_F",
    "si_si_1999_09_09_270_f" = "sisi19990909270f",
    "el_sb_1997_09_19_933_f" = "el_sb_1997_09_19_933_f.",
    "vi_la_1999_05_18_740_f" = "vi_la_1999_05_18_740_f.",
    "si_si_1999_09_09_270_f" = "sisi19990909270f",
    "is_ro_1999_07_27_005_f" = "is_ro_1999_07_27_005_f.",
    "lo_la_1998_05_24_127_m" = "LO_LA_1998_05_24_127_M",
    "gi_ta_1999_12_09_301_f" = "Gi_ta_1999_12_09_01_f",
    "ch_mi_1999_12_02_586_f" = "Ch_mi_1999_12_02_586_f",
    "gi_ta_1999_12_09_301_f" = "Gi_ta_1999_12_09_310_f",
    "el_ma_1999_02_24_116_f" = "el_ma_1999_02_24_16_f",
    "gr_ma_1999_01_11_280_f" = "gr_ma_2000_01_11_280",
    "to_ne_1998_04_28_128_m" = "to_ne_1998_04_28_128_M" ,
    "is_vi_1998_11_04_614_m" = "Is_vi_1998_11_04_614_m.",
    "pe_le_1998_06_19_165_f" = "pe_le_1998_06_19_165_f.",
    "ar_me_1999_08_16_367_f" = "ar_me_1999_08_16_367_f.",
    "al_li_1999_04_22_443_f" = "al_li_1999_04_22_443_f.",
    "co_ro_1999_09_05_550_f" = "co_ro_1999_09_05_550_f.",
    "ma_pi_1999_05_22_724_f" = "ma_pi_1999_05_22_724_f.",
    "ma_li_1998_01_28_040_f" = "Ma_lib_1998_01_28_040_f",
    "el_ma_1999_06_30_238_f" = "el_ma_1999_06_30_238_f.",
    "be_la_2000_02_24_321_f" = "be_la_00_02_24_321_f",
    "mi_tr_1998_06_03_926_f" = "mi_tr_1998_03_926_f",
    "so_ma_1999_11_04_083_f" = "so_ma_1999_11_4_083_f",
    "se_ma_1999_09_12_008_f" = "se_ma_1999_09_12_008_f.",
    "gi_sg_1999_06_20_251_m" = "gisg19990620251m",
    "ce_ro_1999_10_09_556_f" = "ce_ro_19999_10_09_556_f",
    "fe_ve_1998_08_08_634_f" = "fe_ve_1998_08_08_634_f.",
    "fe_ve_1998_08_08_634_f" = "fe_ve_1998_08_08_634_f.",
    "ma_pe_1996_01_02_896_m" = "Ma_pe_1996_01_02_896",
    "no_te_1998_02_20_747_f" = "No_te_1998_02_20_747_f",
    "el_la_1978_02_21_636_f" = "EL_LA_1978_02_21_636_F",
    "an_ma_2000_01_21_914_m" = "an_ma_2000_01_21_914_m.", 
    "fi_po_1995_06_01_748_m" = "fipo19950601748m",
    "va_mo_1972_04_24_610_f" = "vamo19720424610f",
    "fr_po_1999_08_12_277_f" = "Fr_po_1999_08_12_277",
    "el_si_2000_06_14_180_f" = "el_si_2000_06_14_180_f.",
    "cl_ma_1998_07_03_643_m" = "Clma19980703643m",
    "no_li_1999_02_01_404_f" = "no-li-1999-02-01-404-f",
    "so_sp_1999_11_29_476_f" = "so_sp_99_11_29_476_f",
    "el_re_1999_03_18_263_f" = "El_re_1999_03_18_263_f",
    "ol_sa_1999_06_23_763_f" = "Ol_sa_1999_06_23_763_f",
    "gi_te_1985_02_27_346_f" = "GI_TE_1985_02_27_346_F",
    "gi_ro_1998_03_25_382_f" = "gi_ro_1998_03_25_382_f.",
    "al_pe_1953_08_29_187_m" = "al_pe_1953_08_29_87_M",  
    "sa_pr_1998_11_29_011_f" = "sa_pr_1998_11_29_011_f.",
    "va_mo_1972_04_24_610_f" = "vamo19720424610f",
    "ma_pe_1999_01_19_586_f" = "ma_pe_1998_01_19_f",
    "lu_pa_1998_02_09_518_f" = "lu_pa_1998_02_09_51_8_f",
    "ma_sc_1999_01_05_834_m" = "Ma_sc_1999_05_834_m",
    "ca_sa_1999_04_24_425_f" = "ca_sa_1999_04_24_425_f.",
    "fe_fa_1997_06_05_329_f" = "Fe_fa_1997_06_05_329_f",
    "al_za_1999_04_15_094_f" = "al_za_1999_04_15_094_f.",
    "ma_fi_1996_07_02_475_f" = "Ma_fi_1996_07_02_475_f",
    "el_po_1997_11_03_375_f" = "El_po_97_11_3_375_f",
    "gi_be_1997_03_24_841_f" = "gi_be_1997_03_24_841_f.",
    "ma_gu_1997_06_03_597_f" = "ma_gu_1997_06_03_597_f.",
    "sa_fr_1997_02_05_502_f" = "sa_fr_1997_02_05_502-f",
    "no_fi_1997_06_13_335_f" = "no_fi_1997_06_13_335_fi", 
    "lo_ca_1997_06_19_695_m" = "lo_ca_1997_06_19_695_m.",
    "ca_da_1997_12_09_784_f" = "Ca_da_1997_12_09_784_f",
    "er_bo_1997_06_27_610_f" = "Er_bo_1997_06_27_610_f", 
    "so_ce_1996_09_18_036_f" = "So_ce_1996_09_18_036_f.",
    "je_ve_1995_08_03_450_f" = "Je_ve_1995_08_03_450_f",
    "va_ba_1997_12_11_323_f" = "Va_ba_1997_12_11_323_f",
    "fr_ba_1997_10_29_663_f" = "Fr_ba_1997_10_29_663_f",
    "gi_pa_1998_09_14_385_f" = "gi_pa_1998_09_14_385_f.",
    "an_fa_1989_02_15_884_m" = "an_fa_1989_02_15_884_m.",
    "mi_ru_1995_02_03_607_f" = "mi_ru_1995_02_03_607_f.",
    "va_ro_1999_06_07_110_f" = "Va_Ro_1999_07_06_110_f.",
    "si_ca_1997_09_03_861_f" = "SI_CA_1997_09_03_861_f",
    "ce_br_1993_09_13_787_f" = "ce_br_1993_09_13_787_f.",
    "so_go_1997_05_16_135_f" = "SOGO19970516135F",
    "ma_si_1999_05_06_270_f" = "mr_si_1999_05_06_270_f",
    "as_mu_1999_04_24_300_f" = "as_mu_1999_04_24_300_f.",
    "mi_pi_1967_09_14_675_f" = "MI_PI_1967_09_14_675_F",
    "to_or_1999_10_15_120_m" = "to_or_1999_10_15__120_m",
    "mi_ma_1999_04_06_088_f" = "mi_ma_1999_04_06_088_f.",
    "ca_vi_1999_06_17_993_f" = "ca_vi_1999_06_17_993_f.",
    "ca_wi_1997_01_03_432_f" = "ca_wi_97_01_03_432_f.",
    "ne_pu_1995_04_26_095_m" = "ne_pu_1995_04_26_095_m.",
    "al_mi_1997_07_18_032_f" = "AL MI 1997 07 18 032 F",
    "bi_fr_1996_11_15_502_f" = "Bi_fr_1996_11_15_502_f",
    "te_gi_1996_06_15_225_f" = "te_gi_1996_06_15_225_f.",
    "ga_gr_1997_07_07_473_f" = "ga_gr_1997_07_7_473_f",
    "ma_le_1969_07_20_846_f" = "ma_le_1969_07_20_846_f.",
    "an_pi_1997_11_04_116_f" = "An_pi_97_11_04",
    "so_pi_1997_11_13_844_f" = "SO_PI_1997_11_13_844",
    "se_sc_1993_04_30_669_m" = "se_sc_1993_04_30_669_m.",
    "sa_st_2000_02_23_555_f" = "sa_st_2000_02_23_555",
    "br_ta_1997_09_19_562_f" = "Br_ta_1997_09_19_562_f",
    "il_po_1995_08_16_291_f" = "il_po_1995_08_16_291_f.",
    "ch_pi_1997_03_08_754_f" = "CH_PI_03_08_754_f",
    "be_za_1966_01_16_814_f" = "be_za_1966_01_814_f",
    "va_pa_1997_09_23_958_f" = "va_pa_1997_09_23_f",
    "il_pe_1992_09_19_336_f" = "il_pe_1992_1992_09_19_336_f",
    "gi_ma_1996_05_27_066_f" = "gima19960527066f",
    "se_si_1996_09_30_427_f" = "se_si_1996_09_30_427",
    "fe_po_1997_04_13_908_f" = "Fe_po_1997_04_13_908_f",
    "ch_fl_1993_02_19_920_f" = "Ch_fl_1993_02_19_920_f",
    "no_pa_1997_05_01_392_f" = "no_pa_1997_05_1_392_f",
    "sa_sa_1996_01_13_134_f" = "sa_sa_1996_01_13_134_f.",
    "cl_la_1997_11_06_744_f" = "CL_LZ_1997_11_06_744_f.",
    "sa_sa_1996_01_13_134_f" = "sa_sa_1996_01_13_134_f.",
    "gi_ma_1994_12_25_351_f" = "giu_ma_1994_12_25_351_f",
    "ma_pu_1992_08_19_532_f" = "ma_pu_1992_08_19_532", 
    "sa_lu_1997_03_29_600_f" = "sa_lu_1997_03_29_600_f.",
    "ma_ma_1997_08_24_573_f" = "ma_ma_1997_08_24_f",
    "il_na_1997_06_03_198_f" = "il_na__1997_06_03_198_f",
    "la_ma_1994_01_28_662_f" = "la_ma_94_1_28_662_F",
    "vi_pr_1997_05_10_903_f" = "Vi_pr_1997_05_10_903_f",
    "gr_ro_1996_03_21_205_f" = "gr_ro_1996_03_21_205_f.",
    "al_ri_1996_04_24_645_m" = "alri1996424645m",
    "ca_pa_1996_11_06_284_f" = "ca_pa_1996_11_06_284_f.",
    "pi_fr_1998_01_25_889_m" = "PI_FR_1998_01_25_889_M",
    "cl_pu_1997_03_19_031_f" = "clpu19970319031f",
    "al_pa_1999_07_12_052_f" = "alpa19990712052f",
    "ir_la_1996_02_18_100_f" = "Irla_1996_02_18_100_f",
    "di_za_1998_11_01_562_f" = "Di_Za_1998_11_01_562_f.",
    "fr_fa_1997_05_26_034_f" = "FR_FA_1997_05_26_034_f",
    "sa_an_1996_09_15_877_f" = "Sa_an_1996_09_15_877_f",
    "ma_de_1997_05_21_515_f" = "ma_de_1997_05_21_515_f.",
    "si_mu_1999_12_15_300_f" = "Si_mu_1999_12_15_300_f.",
    "ma_so_1998_01_25_827_f" = "Maso19980125827s",
    "gi_be_1997_06_21_518_f" = "gi_be_1997_06_21_518_f.",
    "lu_po_1997_05_16_989_f" = "Lu_po_1997_05_16_989_f",
    "al_fr_1997_09_30_330_f" = "AL_FR_1997_09_30_330_F",
    "er_ma_1997_01_08_572_f" = "ER_MA_1997_01_08_572_F",
    "so_mi_1996_05_05_894_f" = "So_mi_1996_05_05_894_f",
    "gi_ma_1996_05_27_066_f" = "Giu-ma-1996-05-27-066-f",
    "cl_la_1997_11_06_744_f" = "CL_LA_1997_11_06_744_f",
    "di_gi_1995_04_01_339_f" = "digi19950401339f",
    "ar_va_1997_01_25_030_f" = "Ar_va_1997_01_25_030_f",
    "an_pi_1997_11_04_116_f" = "An_pi_1997_11_04_116_f",
    "ca_sv_1997_07_26_869_f" = "ca_sv_97_07_26_869_f",
    "de_de_1995_11_12_937_f" = "De_de_1995_11_12_937_f",
    "gi_gr_1997_05_22_763_m" = "Gi_gr_1997_05_22_763_m.",
    "em_sa_1997_03_22_613_f" = "em_sa_1997_03_613_f",
    "no_va_1998_09_06_480_f" = "no_va_98_09_06_480_f",
    "lu_vu_1997_01_31_072_f" = "lu_vu_1997_01_31_072_fs",
    "ke_po_1999_05_18_020_m" = "kepo19990518020m",
    "lu_di_1997_06_13_195_f" = "Lu_di_1997_06_13_195_f",
    "el_lu_1985_02_27_281_f" = "el_lu_1985_02_27_281",
    "al_gn_1996_07_28_089_f" = "al_ig_1996_07_28_089_f",
    "al_ni_2000_09_01_561_f" = "al_ne_2000_09_01_561_f",
    "al_ti_1999_08_12_864_f" = "al_tr_1999_08_12_867_f",
    "is_nu_1999_07_27_005_f" = "is_ro_1999_07_27_005_f.",
    "sa_pa_1998_11_29_011_f" = "sa_pr_1998_11_29_011_f.",
    "to_mo_1997_05_06_544_m" = "to_mo_1997_05_06_534_m",
    "il_ra_1997_07_26_194_f" = "il_ra_1997_07_26_197_f",
    "ma_li_2000_04_24_987_f" = "ma_li_2000_03_24_987_f",
    "no_sa_1998_01_02_117_f" = "no_sa_1998_02_01_117_f",
    "ch_te_1996_08_04_090_f" = "ch_te_1996_08_04_f",
    "al_ig_1996_07_28_089_f" = "al_gn_1996_07_28_089_f",
    "al_na_1998_05_14_267_f" = "al_na_1998_5_14_267_f",
    "al_ne_2000_09_01_561_f" = "al_ni_2000_09_01_561_f",
    "al_pa_1999_06_01_605_f" = "al_pa_1998_06_01_605_f",
    "al_pa_1999_07_13_052_f" = "al_pa_1999_07_12_052_f",
    "al_ti_1999_08_12_867_f" = "al_ti_1999_08_12_864_f", 
    "ca_ma_1998_04_06_954_f" = "Ca_ma_1998_04_954_f",
    "cl_sc_1994_07_09_141_f" = "cl_sc_1994_07_09_141_F",
    "co_lo_1998_11_16_011_f" = "Co_lo_1998_11_16_011_f",
    "cr_ce_1997_05_13_500_f" = "cr_ce_1997_05_13_500_f.",
    "en_si_1996_03_18_521_f" = "en_si_1996_03_18_521_m",
    "gr_ma_2000_01_11_280_f" = "gr_ma_1999_01_11_280_f",
    "gr_ro_1995_10_24_954_f" = "Gr_ro_1995_10_24_954_f",
    "ma_gr_1997_10_24_010_f" = "ma_go_1997_10_24_010_f", 
    "ma_li_2000_03_24_987_f" = "ma_li_2000_04_24_987_f",
    "ma_pa_1997_05_01_392_f" = "no_pa_1997_05_01_392_f",
    "ma_pa_2000_02_18_503_f" = "ma_pa_2000_02_18_03_f",
    "ni_ma_1999_04_11_032_m" = "Ni_ma_1999_04_11_032_m", 
    "ni_or_1999_05_09_648_f" = "ni_or_1999_09_05_648_f",
    "ni_se_1997_06_03_200_m" = "ni_se_1997_03_06_200_m",
    "no_sa_1998_02_01_117_f" = "no_sa_1998_01_02_117_f",
    "sa_pr_1998_11_29_011_f" = "sa_pa_1998_11_29_011_f",
    "si_fi_1997_02_27_159_f" = "si_fi_1997_02_25_159_f",
    "to_mo_1997_05_06_534_m" = "to_mo_1997_05_06_544_m",
    "va_pa_1997_09_23_758_f" = "va_pa_1997_09_23_958_f",
    "va_de_1994_09_20_783_f" = "Va_de_1994_09_20_783_f.",
    "ma_gu_1997_03_22_733_f" = "ma_gu_1997_03_22_733_f.",
    "an_ma_1995_03_09_029_m" = "an_ma_1995_1995_03_09_029_m",
    "al_li_1999_04_22_443_f" = "al_li_1999_04_22_4443_f.",
    "ma_pu_1992_08_19_532_f" = "ma_pu_1992_8_19_532_f",
    "al_pu_1997_01_25_433_f" = "al_pu_1997_01_25_f",
    "sa_pi_1999_11_25_225_f" = "sa_pi1999_11_25_225f",
    "al_to_1999_04_02_187_f" = "Al_to_1999_04_2_187_f"
  )
  
  tripm <- distinct(tripm_all, subj_code, .keep_all = TRUE)
  length(unique(tripm$subj_code))
  
  # sort(tripm$subj_code)
  
  
  
  # DASS-21 -----------------------------------------------------------------
  
  d1 <- rio::import(
    here(
      "data", "raw", "quest", "DASS-21 psych (Risposte).xlsx"
    )
  )
  
  d2 <- d1[, -14]
  
  dass <- d2[, 14:35] %>% 
    rename(
      subj_code = "Codice identificativo: prime due lettere del nome_prime due lettere del cognome_anno nascita_mese nascita_giorno_ultime tre cifre del cellulare_sesso. Esempio di Mario Rossi, nato il 23 Marzo 1993: ma_ro_1993_03_23_692_m....15",
      DASS_1 = "1) Ho provato molta tensione e ho avuto difficoltà a recuperare uno stato di calma",
      DASS_2 = "2) Mi sono accorto di avere la bocca secca",
      DASS_3 = "3) Non riuscivo proprio a provare delle emozioni positive",
      DASS_4 = "4) Mi sono sentito molto in affanno con difficoltà a respirare (per es. respiro molto accelerato, sensazione di forte affanno in assenza di sforzo fisico)",
      DASS_5 = "5) Ho avuto un’estrema difficoltà nel cominciare quello che dovevo fare",
      DASS_6 = "6) Ho avuto la tendenza a reagire in maniera eccessiva alle situazioni",
      DASS_7 = "7) Ho avuto tremori (per es. alle mani)",
      DASS_8 = "8) Ho sentito che stavo impiegando molta energia nervosa",
      DASS_9 = "9) Ho temuto di trovarmi in situazioni in cui sarei potuto andare nel panico e rendermi ridicolo",
      DASS_10 = "10) Non vedevo nulla di buono nel mio futuro",
      DASS_11 = "11) Mi sono sentito stressato",
      DASS_12 = "12) Ho avuto difficoltà a rilassarmi",
      DASS_13 = "13) Mi sono sentito scoraggiato e depresso",
      DASS_14 = "14) Non riuscivo a tollerare per nulla eventi o situazioni che mi impedivano di portare avanti ciò che stavo facendo",
      DASS_15 = "15) Ho sentito di essere vicino ad avere un attacco di panico",
      DASS_16 = "16) Non c’era nulla che mi dava entusiasmo",
      DASS_17 = "17) Sentivo di valere poco come persona",
      DASS_18 = "18) Mi sono sentito piuttosto irritabile",
      DASS_19 = "19) Ho percepito distintamente il battito del mio cuore senza aver fatto uno sforzo fisico (per es. battito cardiaco accelerato o perdita di un battito)",
      DASS_20 = "20) Mi sono sentito spaventato senza ragione",
      DASS_21 = "21) Sentivo la vita priva di significato"
    ) 
  
  dass$subj_code <- factor(dass$subj_code)
  
  # the second string is what must be changed; 
  # the first sting is the way in which you want it to be changed
  
  dass$subj_code <- fct_recode(
    dass$subj_code, 
    # giusto                     #sbagliato
    "ca_ug_1999_06_22_827_f" = "Ca_ug_1999_06_22_827_f.", 
    "ch_na_1999_08_09_083_f" = "ch_na_1999_08_09_083_f.",
    "ch_vo_1999_05_12_768_f" = "Ch_vo_1999_05_12_768_f",
    "li_st_1997_02_07_509_f" = "LI_ST_1997_02_07_509_F", 
    "al_mi_1997_07_18_032_f" = "AL MI 1997 07 18 032 F",
    "al_fr_1997_09_30_330_f" = "AL_FR_1997_09_30_33O_F",
    "al_li_1999_04_22_443_f" = "al_li_1999_04_22_443_f.",
    "al_ma_2000_02_10_270_f" = "al_ma_2000_02_10_f",
    "al_na_1998_05_14_267_f" = "al_na_1998_5_14_267_f",
    "al_pe_1953_08_29_187_m" = "al_pe_1953_08_29_187_M",
    "al_pe_1998_01_09_983_m" = "al_pe_1998_01_09:983_m",
    "al_za_1999_04_15_094_f" = "al_za_1999_04_15_094_f.",
    "al_pa_1999_07_12_052_f" = "alpa19990712052",
    "al_pa_1999_07_12_052_f" = "alpa19990712052f",
    "al_ri_1996_04_24_645_m" = "alri1996424645m",
    "an_fa_1989_02_15_884_m" = "an_fa_1989_02_15_884_m.",
    "an_ma_2000_01_21_914_m" = "an_ma_2000_01_21_914_m.",
    "an_pi_1997_11_04_116_f" = "An_pi_97_11_04",
    "ar_me_1999_08_16_367_f" = "ar_me_1999_08_16_367_f.",
    "ar_va_1997_01_25_030_f" = "Ar_va_1997_01_25_030_f",
    "as_mu_1999_04_24_300_f" = "as_mu_1999_04_24_300_f.",
    "be_me_1999_11_29_754_f" = "be_me_1999_11_29_754_f.",
    "be_za_1966_01_16_814_f" = "be_za_1966_01_814_f",
    "bi_fr_1996_11_15_502_f" = "Bi_fr_1996_11_15_502_f",
    "bi_za_1998_09_14_029_f" = "BI_ZA_1998_09_14_029_F",
    "br_ta_1997_09_19_562_f" = "Br_ta_1997_09_19_562_f",
    "ca_da_1997_12_09_784_f" = "Ca_da_1997_12_09_784_f",
    "ca_pa_1996_11_06_284_f" = "ca_pa_1996_11_06_284_f.",
    "ca_ro_1996_12_13_249_f" = "ca_ro_1996_12_13_249",
    "ca_sa_1997_06_28_058_f" = "ca_sa_1997_06_28_058_f.",
    "ca_sa_1999_04_24_425_f" = "ca_sa_1999_04_24_425_f.",
    "ca_sv_1997_07_26_869_f" = "ca_sv_97_07_26_869_f",
    "ca_ug_1999_06_22_827_f" = "Ca_ug_1999_06_22_827_f.",
    "ca_vi_1999_06_17_993_f" = "ca_vi_1999_06_17_993_f.",
    "ca_wi_1997_01_03_432_f" = "ca_wi_97_01_03_432_f.",
    "ce_br_1993_13_09_787_f" = "ce_br_1993_13_09_787_f.",
    "ce_va_1998_08_24_343_f" = "ce_va_1998_08_24_343_f.",
    "ch_fl_1993_02_19_920_f" = "Ch_fl_1993_02_19_920_f",
    "ch_na_1999_08_09_083_f" = "ch_na_1999_08_09_083_f.",
    "ch_pi_1997_03_08_754_f" = "CH_PI_1997_03_08_754_f",
    "ch_vo_1999_05_12_768_f" = "Ch_vo_1999_05_12_768_f",
    "cl_la_1997_11_06_744_f" = "CL_LA_1997_11_06_744_f",
    "cl_la_1997_11_06_744_f" = "CL_LA_1997_11_06_744_f",
    "cl_ma_1999_06_09_853_f" = "Cl_ma_1999_06_09_853_f",
    "cl_ma_1998_07_03_643_m" = "Clma19980703643m",
    "cl_pu_1997_03_19_031_f" = "clpu19970319031f",
    "co_ro_1999_09_05_550_f" = "co_ro_1999_09_05_550_f.",
    "de_de_1995_11_12_937_f" = "De_de_1995_11_12_937_f",
    "di_gi_1995_04_01_339_f" = "digi19950401339f",
    "el_la_1978_02_21_636_f" = "EL_LA_1978_02_21_636_F",
    "el_ma_1999_06_30_238_f" = "el_ma_1999_06_30_238_f.",
    "El_po_1997_11_3_375_f" = "El_po_97_11_3_375_f",
    "el_re_1999_03_18_263_f" = "El_re_1999_03_18_263_f",
    "el_sb_1997_09_19_933_f" = "el_sb_1997_09_19_933_f.",
    "el_si_2000_06_14_180_f" = "el_si_2000_06_14_180_f.",
    "er_bo_1996_08_23_595_m" = "er_bo_1996_08_23_595:m",
    "er_bo_1997_06_27_610_f" = "Er_bo_1997_06_27_f",
    "er_ma_1997_01_08_572_f" = "ER_MA_1997_01_08_572_F",
    "al_mi_1997_07_18_032_f" = "AL MI 1997 07 18 032 F",
    "fe_ci_1997_09_24_524_f" = "FE_CI_1997_09_24_524_f.",
    "Fe_fa_1997_06_05_329_f" = "Fe_fa_1997_06_05_f",
    "fe_po_1997_04_13_908_f" = "Fe_po_1997_04_13_908_f",
    "fe_ve_1998_08_08_634_f" = "fe_ve_1998_08_08_634_f.",
    "fi_po_1995_06_01_748_m" = "fipo19950601748m",
    "fr_ba_1997_10_29_663_f" = "Fr_ba_1997_10_29_663_f",
    "fr_fa_1997_05_26_034_f" = "FR_FA_1997_05_26_034_f",
    "fr_po_1999_08_12_277_f" = "Fr_po_1999_08_12_277",
    "ga_gr_1997_07_07_473_f" = "ga_gr_1997_07_7_473_f",
    "gi_be_1997_03_24_841_f" = "gi_be_1997_03_24_841_f.",
    "gi_be_1997_06_21_518_f" = "gi_be_1997_06_21_518_f.",
    "gi_gi_1997_01_15_387_f" = "gi_gi_1997_01_15_387_f.",
    "gi_gr_1997_05_22_763_m" = "Gi_gr_1997__05_22_763_m.",
    "gi_pa_1998_09_14_385_f" = "gi_pa_1998_09_14_385_f.",
    "gi_sp_1991_10_12_767_f" = "Gi_sp_1991_10_12_767_f.",
    "gi_ta_1999_12_09_310_f" = "Gi_ta_1999_12_09_310_f",
    "gi_ma_1996_05_27_066_f" = "gi-ma-1996-05-27-066",
    "gi_ma_1996_05_27_066_f" = "gima19960527066f",
    "gi_sg_1999_06_20_251_m" = "gisg19990620251m",
    "gi_ma_1994_12_25_351_f" = "giu_ma_1994_12_25_351_f",
    "gr_ro_1996_03_21_205_f" = "gr_ro_1996_03_21_205_f.",
    "il_po_1995_08_16_291_f" = "il_po_1995_08_16_291_f.",
    "is_nu_1999_07_27_005_f" = "is_nu_1999_07_27_005_f.",
    "je_ve_1995_08_03_450_f" = "Je_ve_1995_08_03_450_f",
    "la_ba_1995_04_16_716_f" = "la_ba_1995_04_16:716_f",
    "la_ma_1994_01_28_662_f" = "lama94128662F",
    "li_fa_1997_07_03_888_f" = "LI_FA_1997_07_03_888_f",
    "li_go_1997_05_30_338_f" = "Li_go_1997_05_30_338_f.",
    "li_st_1997_02_07_509_f" = "LI_ST_1997_02_07_509_F",
    "lo_ca_1997_06_19_695_m" = "Lo_ca_1997_06_19_695_m",
    "lo_ca_1997_06_19_695_m" = "lo_ca_1997_06_19_695_m.",
    "lo_la_1998_05_24_127_m" = "LO_LA_1998_05_24_127_M",
    "lu_ar_1997_03_19_838_f" = "Lu_ar_1997_03_19_838_f",
    "lu_po_1997_05_16_989_f" = "Lu_po_1997_05__16_989_f",
    "ma_de_1997_05_21_515_f" = "ma_de_1997_05_21_515_f.",
    "ma_gu_1997_06_03_597_f" = "ma_gu_1997_06_03_597_f.",
    "ma_le_1969_07_20_846_f" = "ma_le_1969_07_20_846_f.",
    "ma_pe_1999_01_19_586_f" = "ma_pe_19_1999_586_f",
    "ma_pe_1996_01_02_896_m" = "Ma_pe_1996_01_02_896",
    "ma_pi_1999_05_22_724_f" = "ma_pi_1999_05_22_724_f.",
    "ma_sc_1999_01_05_834_m" = "Ma_sc_1999_05_834_m",
    "ma_se_1996_10_24_008_f" = "Ma_se_1996_10_24_f",
    "ma_so_1998_01_25_827_f" = "Maso19980125827s",
    "mi_ma_1999_04_06_088_f" = "mi_ma_1999_04_06_088_f.",
    "mi_pi_1967_09_14_675_f" = "MI_PI_1967_09_14_675",
    "mi_sa_1999_09_08_167_m" = "Mi_sa_1999_09_08_167_m",
    "ne_pu_1995_04_26_095_m" = "ne_pu_1995_04_26_095_m.",
    "no_te_1998_02_20_747_f" = "No_te_1998_02_20_747_f",
    "no_li_1999_02_01_404_f" = "no-li-1999-02-01-404-f",
    "pe_le_1998_06_19_165_f" = "pe_le_1998_06_19_165_f.",
    "pi_fr_1998_01_25_889_m" = "PI_FR_1998_01_25_889_M",
    "re_pa_1999_10_29_898_f" = "re_pa_1999_10_29_898_f.",
    "re_po_1999_01_01_605_f" = "Re_po_1999_01_01_605_f",
    "re_sa_1999_07_27_842_f" = "re_sa_1999_07_27_842_f.",
    "ro_sa_1994_03_16_497_f" = "ro_sa_1994_16_497_f",
    "ro_sa_1994_03_16_497_f" = "ro_sa_1994_16_497_f",
    "sa_an_1996_09_15_877_f" = "Sa_an_1996_09_15_877_f",
    "sa_sa_1997_01_13_134_f" = "sa_sa_1997_01_13_134_f.",
    "sa_st_2000_02_23_555_f" = "sa_st_2000_02_23_555",
    "se_ma_1999_09_12_008_f" = "se_ma_1999_09_12_008_f.",
    "se_sc_1993_04_30_669_m" = "se_sc_1993_04_30_669_m.",
    "si_ca_1997_09_03_861_f" = "SI_CA_1997_09_03_861_f",
    "si_mu_1999_12_15_300_f" = "Si_mu_1999_12_15_300_f.",
    "so_ce_1996_09_18_036_f" = "so_ce_1996_09_18_036_f.",
    "so_pi_1997_11_13_844_f" = "SO_PI_1997_11_13_844_f",
    "so_pi_1997_11_13_844_f" = "SO_PI_1997_11_13_844_f",
    "so_sp_1999_11_29_476_f" = "so_sp_1999_11_29_476_f.",
    "so_go_1997_05_16_135_f" = "SOGO19970516135F",
    "te_gi_1996_06_15_225_f" = "te_gi_1996_06_15_225_f.",
    "va_ba_1997_12_11_323_f" = "Va_ba_1997_12_11_323",
    "va_gu_1974_08_05_685_f" = "va_gu.1974_08_05_685_f",
    "va_pa_1997_09_23_958_f" = "va_pa_1997_09_23_f",
    "va_ro_1999_06_07_110_f" = "Va_ro_1999_06_07_110_f",
    "va_mo_1972_04_24_610_f" = "vamo19720424610f",
    "vi_la_1999_05_18_740_f" = "vi_la_1999_05_18_740_f.",
    "vi_pr_1997_05_10_903_f" = "Vi_pr_1997_05_10_903_f", 
    "al_pa_1999_07_13_052_f" = "al_pa_1999_07_12_052_f", 
    "al_ti_1999_08_12_867_f" =  "al_tr_1999_08_12_867_f", 
    "al_to_1999_05_18_020_m" = "ke_po_1999_05_18_020_m", 
    "be_la_2000_02_24_321_f" = "be_la_00_02_24_321_f", 
    "be_lo_2000_02_24_900_f" =  "be_lo_2000_02_21_900_f", 
    "be_ma_1998_02_04_443_f" =  "be_ma_1998_04_02_443_f",  
    "ca_ma_1998_04_06_954_f" =  "Ca_ma_1998_04_954_f",
    "ca_pr_1998_05_03_121_f" = "ca_pr_1998_05_06_121_f",  
    "ce_br_1993_09_13_787_f" = "ce_br_1993_13_09_787_f", 
    "ce_ro_1999_10_09_556_f" =  "ce_ro_1999_10_09_557_m", 
    "cl_sc_1994_07_09_141_f" =  "cs_sc_1994_07_09_141_F",
    "co_lo_1998_11_16_011_f" =  "Co_lo_1998_11_16_011_f",
    "co_ro_1998_01_15_053_f" =  "co_ro_1998_15_01_f",
    "de_ri_1996_05_11_537_f" =  "De_ri_1996_05_11_537_f",
    "el_lu_1985_02_27_281_f" =  "el_lu_1985_02_27_281" ,
    "el_po_1997_11_03_375_f" = "El_po_1997_11_3_375_f",
    "fe_fa_1997_06_05_329_f" = "Fe_fa_1997_06_05_329_f",
    "fr_se_1997_08_13_241_f" = "fr_se_1998_08_13_241_f", 
    "gi_co_1997_03_01_611_f" =  "gi_co_1997_03_01_f", 
    "gi_sp_1991_12_10_767_f" = "gi_sp_1991_10_12_767_f", 
    "gi_ta_1999_12_09_301_f" = "gi_ta_1999_12_09_310_f" , 
    "gr_ro_1995_10_24_954_f" = "Gr_ro_1995_10_24_954_f.",
    "lu_qu_1996_11_14_138_f" = "Lu_qu_1996_11_14_138_f",
    "ma_gr_1997_10_24_010_f" =  "ma_go_1997_10_24_010_f", 
    "ma_pa_1997_05_01_392_f" = "no_pa_1997_05_1_392_f", 
    "ni_ma_1999_04_11_032_m" = "Ni_ma_1999_04_11_032_m",
    "ni_or_1999_05_09_648_f" = "ni_or_1999_09_05_648_f",
    "ni_se_1997_06_03_200_m" = "ni_se_1997_03_06_200_m", 
    "sa_sa_1996_01_13_134_f" = "sa_sa_1997_01_13_134_f", 
    "si_fi_1997_02_27_159_f" = "si_fi_1997_02_25_159_f", 
    "to_lu_1999_09_19_987_m" = "to_lu_1999_09_19_987",
    "va_pa_1997_09_23_758_f" = "va_pa_1997_09_23_958_f", 
    "en_si_1996_03_18_521_m" = "en_si_1996_03_18_521_f",
    "ir_la_1996_02_18_100_f" = "Ir_la_1996_02_18_100_f",
    "va_de_1994_09_20_783_f"  = "Va_de_1994_09_20_783_f.",
    "fr_vi_1998_02_11_212_f" = "Fr_vi_1998-02-11-212-f.",
    "al_li_1999_04_22_443_f" = "al_li_1999_04_22_4443_f.",
    "al_pu_1997_01_25_433_f" = "al_pu_1997_01_25_433",
    "an_ma_1995_03_09_029_m" = "an_ma_1995_1995_03_09_029_m",
    "al_to_1999_04_02_187_f" = "Al_to_1999_2_187_f",
    "el_po_1997_11_03_375_f" = "El_po_1997_11_3_375_f",
    "ma_pu_1992_08_19_532_f" = "ma_pu_1992_8_19_532_f"
  )
  
  dass_21 <- distinct(dass, subj_code, .keep_all = TRUE)
  length(unique(dass$subj_code))
  
  # sort(dass$subj_code)
  
  
  
  # Rosenberg ---------------------------------------------------------------
  
  
  temp <- rio::import(
    here(
      "data", "raw", "quest", "Scala di Rosenberg (Risposte).xlsx"
    )
  )
  
  ros_scale_tot <- temp[, 3:13] %>% 
    rename(
      subj_code = `Codice identificativo: prime due lettere del nome_prime due lettere del cognome_anno nascita_mese nascita_giorno_ultime tre cifre del cellulare_sesso. Esempio di Mario Rossi, nato il 23 Marzo 1993: ma_ro_1993_03_23_692_m.`,
      ROS_1 = `1. Penso di valere almeno quanto gli altri`,
      ROS_2 = `2. Penso di avere un certo numero di qualità`,
      ROS_3 = "3. Sono portato a pensare di essere un vero fallimento",
      ROS_4 = "4. Sono in grado di fare le cose bene almeno come la maggior parte delle persone",
      ROS_5 = "5. Penso di non avere molto di cui essere fiero",
      ROS_6 = "6. Ho un atteggiamento positivo verso me stesso",
      ROS_7 = "7. Complessivamente sono soddisfatto di me stesso",
      ROS_8 = "8. Desidererei avere maggior rispetto di me stesso",
      ROS_9 = "9. Qualche volta mi sento proprio inutile",
      ROS_10 = "10. A volte penso di essere un buono a nulla"
    ) 
  
  ros_scale_tot <- ros_scale_tot[-207, ]
  
  # the second string is what must be changed; 
  # the first sting is the way in which you want it to be changed
  ros_scale_tot$subj_code <- factor(ros_scale_tot$subj_code)
  
  ros_scale_tot$subj_code <- fct_recode(
    ros_scale_tot$subj_code, 
    "ch_vo_1999_05_12_768_f" = "Ch_vo_1999_05_12_768_f",
    "ca_ug_1999_06_22_827_f" = "ca_ug_1999_06_22_827_f.",
    "ce_va_1998_08_24_343_f" = "ce_va_1998_08_24_343_f.",
    "el_sb_1997_09_19_933_f" = "el_sb_1997_09_19_933_f.",
    "vi_la_1999_05_18_740_f" = "vi_la_1999_05_18_740_f." ,
    "gi_ta_1999_12_09_310_f" = "Gi_ta_1999_12_09_310_f",
    "re_sa_1999_07_27_842_f" = "re_sa_1999_07_27_842_f.",
    "al_ni_2000_09_01_561_f" = "al_ne_2000_09_01_561_f",
    "pe_le_1998_06_19_165_f" = "pe_le_1998_06_19_165_f.",
    "al_li_1999_04_22_433_f" = "al_li_1999_04_22_443_f.",
    "re_po_1999_01_01_605_f" = "Re_po_1999_01_01_605_f",
    "li_st_1997_02_07_509_f" = "LI_ST_1997_02_07_509_F",
    "gi_sg_1999_06_20_261_m" = "gisg19990620251m",
    "el_la_1978_02_21_636_f" = "EL_LA_1978_02_21_636_F",
    "el_ma_1999_06_30_238_f" = "el_ma_1999_06_30_238_f.",
    "se_ma_1999_09_12_008_f" = "se_ma_1999_09_12_008_f.",
    "co_ro_1999_09_05_550_f" = "co_ro_1999_09_05_550_f.",
    "fe_ve_1998_08_08_634_f" = "fe_ve_1998_08_08_634_f.",
    "el_si_2000_06_14_180_f" = "el_si_2000_06_14_180_f.",
    "cl_ma_1998_07_03_643_m" = "Clma19980703643m",
    "an_ma_2000_01_21_914_m" = "an_ma_2000_01_21_914_m.", 
    "fr_po_1999_08_12_277_f" = "Fr_po_1999_08_12_277_f", 
    "ch_na_1999_08_09_083_f" = "ch_na_1999_08_09_083_f." ,
    "ch_mi_1999_12_02_586_f" = "ch_mi_1999_12_02_586_f.",
    "ma_pe_1996_01_02_896_m" = "Ma_pe_1996_01_02_896",
    "mi_re_1997_11_18_718_m" = "mi_re_1997_11_\\8_718_m",
    "el_me_1999_02_18_206_f" = "el_men_1999_02_18_206_f",
    "ma_pi_1999_05_22_724_f" = "ma_pi_1999_05_22_724_f.",
    "lo_la_1998_05_24_127_m" = "LO_LA_1998_05_24_127_M",
    "al_ma_2000_02_10_270_f" = "al_ma_2000_02_10_270",
    "ar_me_1999_08_16_367_f" = "ar_me_1999_08_16_367_f.",
    "el_re_1999_03_18_263_f" = "El_re_1999_03_18_263_f",
    "ma_sc_1999_01_05_834_m" = "Ma_sc_1999_05_834_m",
    "ca_sa_1999_04_24_425_f" = "ca_sa_1999_04_24_425_f.",
    "el_po_1997_11_03_375_f" = "El_po_97_11_3_375_f",
    "ma_fi_1996_07_02_475_f" = "Ma_fi_1996_07_02_475_f",
    "ma_gu_1997_06_03_597_f" = "ma_gu_1997_06_03_597_f.",
    "gi_be_1997_03_21_841_f" = "gi_be_1997_03_24_841_f.",
    "lo_ca_1997_06_19_695_m" = "lo_ca_1997_06_19_695_m.",
    "er_bo_1997_06_27_610_f" = "Er_bo_1997_06_27_610_f",
    "so_ce_1996_09_18_036_f" = "So_ce_1996_09_18_036_f.",
    "fr_ba_1997_10_29_663_f" = "Fr_ba_1997_10_29_663_f",
    "an_fa_1989_02_15_884_m" = "an_fa_1989_02_15_884_m.",
    "gi_pa_1998_09_14_385_f" = "gi_pa_1998_09_14_385_f.",
    "va_ba_1997_12_11_323_f" = "Va_ba_1997_12_11_323_f",
    "ca_da_1997_12_09_784_f" = "Ca_da_1997_12_09_784_f",
    "si_ca_1997_09_03_861_f" = "SI_CA_1997_09_03_861_f",
    "ce_br_1993_09_13_787_f" = "ce_br_1993_09_13_787_f.",
    "so_go_1997_05_15_135_f" = "SOGO19970515135F",
    "ma_ta_1999_03_25_767_f" = "ma_ta_1999_03_25_f",
    "sa_pr_1998_11_29_011_f" = "sa_pr_1998-11_29_011_f",
    "as_mu_1999_04_24_300_f" = "as_mu_1999_04_24_300_f.",
    "mi_ma_1999_04_06_088_f" = "mi_ma_1999_04_06_088_f.",
    "va_ro_1999_06_07_110_f" = "Va_ro_1999_06_07_110_f",
    "fi_po_1995_06_01_748_m" = "fipo19950601748m",
    "mi_pi_1967_09_14_675_f" = "MI_PI_1967_09_14_675",
    "ca_wi_1997_01_03_432_f" = "ca_wi_97_01_03_432_f.",
    "ne_pu_1995_04_26_095_m" = "ne_pu_1995_04_26_095_m.",
    "no_li_1999_02_01_404_f" = "no_li_1999_02_01_404",
    "al_mi_1997_07_18_032_f" = "AL MI 1997 07 18 032 F",
    "bi_fr_1996_11_15_502_f" = "Bi_fr_1996_11_15_502_f",
    "te_gi_1996_06_15_225_f" = "te_gi_1996_06_15_225_f.", 
    "ga_gr_1997_07_07_473_f" = "ga_gr_1997_07_7_473_f",
    "ma_le_1969_07_20_846_f" = "ma_le_1969_07_20_846_f.",
    "an_pi_1997_11_04_116_f" = "An_pi_97_11_04",
    "so_pi_1997_11_13_844_f" = "SO_PI_1997_11_13_844",
    "se_sc_1993_04_30_669_m" = "se_sc_1993_04_30_669_m.",
    "sa_st_2000_02_23_555_f" = "sa_st_2000_02_23_555",
    "ja_no_1999_07_13_625_m" = "ja_no_1999_07_13_625",
    "br_ta_1997_09_19_562_f" = "Br_ta_1997_09_19_562_f",
    "il_po_1995_08_16_291_f" = "il_po_1995_08_16_291_f.",
    "ch_pi_1997_03_08_754_f" = "CH_PI_03_08_754_f",
    "be_za_1966_01_16_814_f" = "be_za_1966_01_814_f",
    "va_pa_1997_09_23_958_f" = "va_pa_1997_09_23_f",
    "ca_vi_1999_06_17_993_f" = "ca_vi_1999_06_17_993_f.",
    "gi_ma_1996_05_27_066_f" = "gima19960527066f",
    "fe_po_1997_04_13_908_f" = "Fe_po_1997_04_13_908_f",
    "cl_la_1997_11_06_744_f" = "CL_LZ_1997_11_06_744_f.",
    "sa_sa_1996_01_13_134_f" = "sa_sa_1996_01_13_134_f.",
    "gi_ma_1994_12_25_351_f" = "giu_ma_1994_12_25_351_f",
    "ma_pu_1992_08_19_532_f" = "ma_pu_1992_08_19_532",
    "sa_lu_1997_03_29_600_f" = "sa_lu_1997_03_29_600_f.",
    "gi_sp_1991_12_10_767_f" = "Gi_sp_1991_10_12_767_f.",
    "ch_fl_1993_02_19_920_f" = "Ch_fl_1993_02_19_920_f",
    "ma_ma_1997_08_24_573_f" = "ma_ma_1997_08_24_f",
    "la_ma_1994_01_28_662_f" = "la_ma_94_1_28_662_F",
    "vi_pr_1997_05_10_903_f" = "Vi_pr_1997_05_10_903_f",
    "gr_ro_1996_03_21_205_f" = "gr_ro_1996_03_21_205_f.",
    "al_ri_1996_04_24_645_m" = "alri1996424645m",
    "ca_pa_1996_11_06_284_f" = "ca_pa_1996_11_06_284_f.",
    "al_ma_2000_02_10_270_f" = "al_ma_2000_02_10_270",
    "pi_fr_1998_01_25_889_m" = "PI_FR_1998_01_25_889_M",
    "cl_pu_1997_03_19_031_f" = "clpu19971903031f",
    "al_pa_1999_07_12_052_f" = "alpa19990712052f",
    "fr_fa_1997_05_26_034_f" = "FR_FA_1997_05_26_034_f",
    "sa_an_1996_09_15_877_f" = "Sa_an_1996_09_15_877_f",
    "ma_de_1997_05_21_515_f" = "ma_de_1997_05_21_515_f.",
    "ma_so_1998_01_25_827_f" = "Maso19980125827s",
    "gi_be_1997_06_21_518_f" = "gi_be_1997_06_21_518_f.",
    "lu_po_1997_05_16_989_f" = "Lu_po_1997_05_16_989_f",
    "al_fr_1997_09_30_330_f" = "AL_FR_1997_09_30_330_F",
    "ir_la_1996_02_18_100_f" = "Ir_la_1996_02_18_100_f",
    "er_ma_1997_01_08_572_f" = "ER_MA_1997_01_08_572_F",
    "so_mi_1996_05_05_894_f" = "So_mi_1996_05_05_894_f",
    "gi_ma_1996_05_27_066_f" = "gi-ma-1996-05-27-066-f",
    "cl_la_1997_11_06_744_f" = "CL_LA_1997_11_06_744_f" ,
    "di_gi_1995_04_01_339_f" = "digi19950401339f",
    "si_mu_1999_12_15_300_f" = "Si_mu_1999_12_15_300_f.", 
    "ar_va_1997_01_25_030_f" = "Ar_va_1997_01_25_030_f",
    "ca_sv_1997_07_26_869_f" = "ca_sv_97_07_26_869_f",
    "bi_za_1998_09_14_029_f" = "BI_ZA_1998_09_14_029_F",
    "de_de_1995_11_12_937_f" = "De_de_1995_11_12_937_f",
    "be_me_1999_11_29_754_f" = "be_me_1999_11_29_754_f.",
    "gi_gr_1997_05_22_763_m" = "Gi_gr_1997_05_22_763_m",
    "fi_ma_1999_10_01_190_m" = "fi_ma_1999_01_10_334_m",
    "re_pa_1999_10_29_898_f" = "re_pa_1999_10_29_898_f.",
    "lu_di_1997_06_13_195_f" = "Lu_di_1997_06_13_195_f",
    "al_gn_1996_07_28_089_f" = "al_ig_1996_07_28_089_f",
    "el_lu_1985_02_27_281_f" = "el_lu_1985_02_27_281", 
    "al_ig_1996_07_28_089_f" = "al_gn_1996_07_28_089_f",
    "al_li_1999_04_22_443_f" = "al_li_1999_04_22_433_f",
    "al_ne_2000_09_01_561_f" = "al_ni_2000_09_01_561_f",
    "al_pa_1999_07_13_052_f" = "al_pa_1999_07_12_052_f",
    "al_ti_1999_08_12_867_f" = "al_tr_1999_08_12_867_f",
    "al_ne_2000_09_01_561_f" = "al_ni_2000_09_01_561_f",
    "al_za_1999_04_15_094_f" = "al_za_1999_04_15_094_f",
    "be_la_2000_02_24_321_f" = "be_lo_2000_02_24_900_f",
    "ca_ma_1998_04_06_954_f" = "Ca_ma_1998_04_06_954_f", 
    "ca_pr_1998_05_03_121_f" = "ca_pr_1998_03_05_121_f",
    "co_lo_1998_11_16_011_f" = "Co_lo_1998_11_16_011_f",
    "al_ig_1996_07_28_089_f" = "al_gn_1996_07_28_089_f",
    "al_to_1999_05_18_020_m" = "ke_po_1999_05_18_020_m",
    "al_za_1999_04_15_094_f" = "al_za_1999_04_15_094_f",
    "cr_ce_1997_05_13_500_f" = "cr_ce_1997_05_13_500_f",
    "al_ig_1996_07_28_089_f" = "al_gn_1996_07_28_089_f",
    "al_za_1999_04_15_094_f" = "al_za_1999_04_15_094_f",
    "be_lo_2000_02_24_900_f" = "be_la_2000_02_24_321_f",
    "cr_ce_1997_05_13_500_f" = "cr_ce_1997_05_13_500_f",
    "el_me_1997_08_29_639_f" = "el_me_1997_08_29_788_f",
    "en_si_1996_03_18_521_f" = "en_si_1996_03_18_521_m",
    "gi_be_1997_03_24_841_f" = "gi_be_1997_03_21_841_f",
    "gi_di_1997_04_11_362_f" = "gi_ba_1997_04_21_362_f",
    "gi_ri_1999_01_18_570_m" = "gi_ri_1999_09_10_859_m",
    "al_ig_1996_07_28_089_f" = "al_gn_1996_07_28_089_f",
    "al_za_1999_04_15_094_f" = "al_za_1999_04_15_094_f",
    #"be_lo_2000_02_24_900_f"= "be_la_2000_02_24_321_f",
    "cr_ce_1997_05_13_500_f" = "cr_ce_1997_05_13_500_f",
    "en_si_1996_03_18_521_m" = "en_si_1996_03_18_521_f",
    "gi_ba_1997_04_21_362_f" = "gi_di_1997_04_11_362_f", 
    "gi_sg_1999_06_20_251_m" = "gi_sg_1999_06_20_261_m",
    "gi_ta_1999_12_09_301_f" = "gi_ta_1999_12_09_310_f", 
    "gr_ro_1995_10_24_954_f" = "Gr_ro_1995_10_24_954_f",
    "il_ra_1997_07_26_194_f" = "il_ra_1997_07_26_197_f",
    "ma_gr_1997_10_24_010_f" = "ma_go_1997_10_24_010_f",
    "ma_pa_1997_05_01_392_f" = "no_pa_1997_05_1_392_f",
    "ni_ma_1999_04_11_032_m" = "Ni_ma_1999_04_11_032_m",
    "ni_nu_1997_06_30_681_f" = "ni_nu_1997_06_30_f",  
    "ni_or_1999_05_09_648_f" = "ni_or_1999_09_05_648_f", 
    "ni_se_1997_06_03_200_m" = "ni_se_1997_03_06_200_m", 
    "no_te_1998_02_20_747_f" = "no_te_1998_03_20_747_f", 
    "si_fi_1997_02_27_159_f" = "si_fi_1997_02_25_159_f",
    "so_go_1997_05_16_135_f" = "so_go_1997_05_15_135_f",
    "st_am_1997_09_25_795_f" = "st_am_1997_09_25_f", 
    "va_pa_1997_09_23_758_f" = "va_pa_1997_09_23_958_f", 
    "al_li_1999_04_22_443_f" = "al_li_1999_04_22_433_f",
    "al_za_1999_04_15_094_f"= "al_za_1999_04_15_094_f",
    "va_de_1994_09_20_783_f" = "Va_de_1994_09_20_783_f.",
    "sa_pi_1999_11_25_225_f" = "sa_pi1999_11_25_225f",
    "be_la_2000_02_24_321_f" = "be_la_00_02_24_321_f",
    "al_za_1999_04_15_094_f" = "al_za_1999_04_15_094_f.",
    "cr_ce_1997_05_13_500_f" = "cr_ce_1997_05_13_500_f."
  )
  
  # sort(ros_scale_tot$subj_code)
  
  rosenberg <- distinct(ros_scale_tot, subj_code, .keep_all = TRUE)
  length(unique(rosenberg$subj_code))
  
  
  
  temp1 <- left_join(tripm, dass_21, by = "subj_code")
  quest_dat <- left_join(temp1, rosenberg, by = "subj_code")
  
  # Imputation for DASS-21 and Rosenberg scale.
  foo <- quest_dat %>% 
    dplyr::select(-subj_code)
  
  imp <- mice::mice(foo, method = "norm.predict", m = 1) 
  temp <- complete(imp)
  
  temp2 <- temp %>% 
    mutate(
      across(everything(), round)
    )
  # summary(temp2)
  
  temp2$DASS_7 <- ifelse(temp2$DASS_7 < 0, 0, temp2$DASS_7)
  temp2$DASS_9 <- ifelse(temp2$DASS_9 < 0, 0, temp2$DASS_9)
  temp2$DASS_15 <- ifelse(temp2$DASS_15 < 0, 0, temp2$DASS_15)
  # summary(temp2)
  
  thedat <- temp2
  thedat$subj_code <- quest_dat$subj_code
  
  # Save recoded questionnaires data in a RDS file
  saveRDS(
    thedat,
    here(
      "data", "processed", "quest", "quest_tripm_cntrl.rds"
    )
  )
  
}






